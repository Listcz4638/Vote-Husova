<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8">
  <title>VÃ½sledky hlasovÃ¡nÃ­ â€“ Husova</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="/husovalogo.png">
</head>
<body>

<h1>ğŸ“Š VÃ½sledky hlasovÃ¡nÃ­</h1>

<script>
async function loadResults() {
  const key = localStorage.getItem("adminKey") || prompt("Zadej admin klÃ­Ä:");
  if (!key) return;

  localStorage.setItem("adminKey", key);

  const res = await fetch("/api/results?key=" + encodeURIComponent(key));
  if (!res.ok) {
    alert("âŒ Å patnÃ½ admin klÃ­Ä nebo chyba serveru");
    return;
  }

  const data = await res.json();
  const results = data.results || {};

  const tbody = document.getElementById("resultsBody");
  tbody.innerHTML = "";

  const entries = Object.entries(results).sort((a,b) => b[1]-a[1]);
  for (const [name, count] of entries) {
    const tr = document.createElement("tr");
    tr.innerHTML = `<td>${name}</td><td>${count}</td>`;
    tbody.appendChild(tr);
  }

  document.getElementById("totalVotes").textContent = data.total ?? 0;
}

window.addEventListener("DOMContentLoaded", loadResults);
</script>
</body>
</html>
<h2>VÃ½sledky (celkem hlasÅ¯: <span id="totalVotes">0</span>)</h2>

<table>
  <thead>
    <tr><th>SoutÄ›Å¾Ã­cÃ­</th><th>PoÄet hlasÅ¯</th></tr>
  </thead>
  <tbody id="resultsBody"></tbody>
</table>
